<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>InformData Statewide Coverage vs. County Requirements</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles/tokens.css" />
</head>
<body class="page-product">
  <div data-include="components/header.html"></div>
  <main class="page" id="main-content">
    <section>
      <h1>Fulfillment Methods (Statewide vs County Workflows)</h1>
      <p class="lead">Which states let a single statewide search satisfy county requirements, and which are fulfilled via county research. Data from InformData’s statewide workbook (<strong>SW Sources 8.24</strong>) plus coverage notes.</p>
      <div class="stat-grid" id="stats"></div>
      <div class="callout">
        <strong>How to read this:</strong>
        <ul>
          <li><em>Statewide wins</em> &mdash; InformData maintains a statewide repository that satisfies county requirements.</li>
          <li><em>County coverage</em> &mdash; Orders are fulfilled by working the counties directly (no single statewide file or statewide data is supplementary only).</li>
        </ul>
      </div>
    </section>

    <section>
      <h2>Quick lists</h2>
      <div class="pill-grid" id="list-statewide"></div>
      <div class="pill-grid" id="list-county"></div>
      <div id="list-note"></div>
    </section>

    <section>
      <h2>Dive deeper</h2>
      <div class="chip-row">
        <button class="chip active" data-filter="all">All states</button>
        <button class="chip" data-filter="statewide">Statewide covers counties</button>
        <button class="chip" data-filter="county">County coverage</button>
      </div>
      <table id="coverage-table" aria-live="polite">
        <thead>
          <tr>
            <th>State</th>
            <th>Statewide covers county?</th>
            <th>Recommended method</th>
            <th>Repository</th>
            <th>Courts sourced</th>
            <th>Notes</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <section>
      <h2>Operational notes</h2>
      <ul>
        <li><strong>Pricing impact:</strong> For statewide wins, sales can price county checks as state pulls (see pricing sheet). For county-required states, keep the higher court-runner rate.</li>
        <li><strong>Automation:</strong> States flagged “Auto FE” or “Auto CCH” run through InformData’s automated footprint, reducing turnaround time.</li>
        <li><strong>Exceptions:</strong> Indiana, Missouri, Pennsylvania, and Wisconsin appear twice in the source data. InformData explicitly recommends the statewide repository for county coverage in these states, so we treat them as statewide wins.</li>
        <li><strong>No statewide repository ≠ no coverage:</strong> “No statewide repository” simply means InformData does not have a single statewide file. In nearly every case it still fulfills orders by working the counties directly.</li>
      </ul>
    </section>
  </main>

  <script>
    async function loadCoverage() {
      const response = await fetch('content/pricing/informdata_statewide_coverage.csv');
      const text = await response.text();
      const lines = text.trim().split(/\r?\n/);
      const headers = lines.shift().split(',');
      const records = lines.map(line => {
        const values = [];
        let current = '';
        let inQuotes = false;
        for (let i = 0; i < line.length; i++) {
          const char = line[i];
          if (char === '"') {
            inQuotes = !inQuotes;
          } else if (char === ',' && !inQuotes) {
            values.push(current.trim());
            current = '';
          } else {
            current += char;
          }
        }
        values.push(current.trim());
        const obj = {};
        headers.forEach((key, idx) => {
          obj[key] = values[idx] ? values[idx].replace(/^"|"$/g, '') : '';
        });
        return obj;
      });

      const categories = {
        statewide: records.filter(r => r.statewide_recommended === 'Yes'),
        county: records.filter(r => r.statewide_recommended !== 'Yes')
      };
      const totals = {
        statewide: categories.statewide.length,
        county: categories.county.length,
        all: records.length
      };
      const statsEl = document.getElementById('stats');
      statsEl.innerHTML = `
        <div class="stat-card"><strong>${totals.statewide}</strong><span>States where a statewide search satisfies county coverage.</span></div>
        <div class="stat-card"><strong>${totals.county}</strong><span>States fulfilled via county researchers or portals.</span></div>
      `;

      function buildList(targetId, items, heading) {
        if (!items.length) return;
        const container = document.getElementById(targetId);
        const title = document.createElement('div');
        title.className='group-title';
        title.textContent = heading;
        container.appendChild(title);
        items
          .sort((a,b)=> a.state_name.localeCompare(b.state_name))
          .forEach(item => {
            const pill = document.createElement('span');
            pill.className='pill';
            pill.textContent=item.state_name;
            container.appendChild(pill);
          });
      }

      buildList('list-statewide', categories.statewide, 'Statewide covers county requirements');
      buildList('list-county', categories.county, 'Covered via county research only');
      const noteContainer = document.getElementById('list-note');
      if (noteContainer) {
        const note = document.createElement('div');
        note.className = 'callout';
        note.textContent = 'Every state is serviced: where no statewide file exists, InformData dispatches county researchers to fulfill orders.';
        noteContainer.appendChild(note);
      }

      const tbody = document.querySelector('#coverage-table tbody');
      function renderTable(data) {
        tbody.innerHTML = data.map(row => `
          <tr>
            <td>${row.state_name}</td>
            <td>${row.statewide_recommended === 'Yes' ? 'Yes' : 'No'}</td>
            <td>${row.recommended_method}</td>
            <td>${row.repository}</td>
            <td>${row.courts_sourced || ''}</td>
            <td>${row.details || ''}</td>
          </tr>
        `).join('');
      }

      renderTable(records);

      document.querySelectorAll('button.chip').forEach(button => {
        button.addEventListener('click', () => {
          document.querySelectorAll('button.chip').forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');
          const filter = button.dataset.filter;
          if (filter === 'statewide') renderTable(categories.statewide);
          else if (filter === 'county') renderTable(categories.county);
          else renderTable(records);
        });
      });
    }

    loadCoverage();
  </script>
  <div data-include="components/footer.html"></div>
  <script src="components/include.js" defer></script>
</body>
</html>
