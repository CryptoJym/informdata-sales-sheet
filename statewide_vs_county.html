<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>InformData Statewide Coverage vs. County Requirements</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles/tokens.css" />
  <style>
    main { max-width: 1200px; margin: 0 auto; padding: 2.5rem 1.5rem 4rem; display: grid; gap: 2rem; }
    h1 { margin: 0; font-size: var(--fs-xxl); letter-spacing: -0.02em; }
    p.lead { font-size: 1.05rem; color: var(--muted); max-width: 70ch; }
    section { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-xl); padding: 1.6rem 1.8rem; box-shadow: var(--shadow-lg); display: grid; gap: 1rem; }
    .stat-grid { display: grid; gap: 1rem; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
    .stat-card { background: var(--accent-soft); border-radius: var(--radius-lg); padding: 1.1rem 1.25rem; border: 1px solid rgba(37, 99, 235, 0.18); box-shadow: inset 0 1px 0 rgba(255,255,255,0.35); }
    .stat-card strong { display: block; font-size: 2rem; font-weight: 700; }
    .stat-card span { font-size: var(--fs-sm); color: var(--muted); }
    .chip-row { display: flex; flex-wrap: wrap; gap: 0.6rem; }
    button.chip { border: 1px solid var(--border); background: var(--surface); color: var(--muted); padding: 0.45rem 0.85rem; border-radius: var(--radius-pill); font-size: 0.85rem; font-weight: 600; cursor: pointer; transition: all 0.15s ease; }
    button.chip.active { background: var(--accent); color: #fff; border-color: var(--accent); box-shadow: 0 10px 20px rgba(37, 99, 235, 0.22); }
    table { width: 100%; border-collapse: collapse; border: 1px solid var(--border); border-radius: var(--radius-xl); overflow: hidden; }
    thead th { background: var(--accent-soft); padding: 0.75rem; font-size: var(--fs-xs); text-transform: uppercase; letter-spacing: 0.04em; text-align: left; }
    tbody td { padding: 0.7rem; border-bottom: 1px solid var(--border); vertical-align: top; font-size: 0.95rem; }
    tbody tr:nth-child(even) { background: rgba(37, 99, 235, 0.05); }
    .list-columns { display: grid; gap: 0.75rem; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
  </style>
</head>
<body>
  <div data-include="components/header.html"></div>
  <main>
    <section>
      <h1>Fulfillment Methods (Statewide vs County Workflows)</h1>
      <p class="lead">Which states let a single statewide search satisfy county requirements, and which are fulfilled via county research. Data from InformData’s statewide workbook (<strong>SW Sources 8.24</strong>) plus coverage notes.</p>
      <div class="stat-grid" id="stats"></div>
      <div class="callout">
        <strong>How to read this:</strong>
        <ul>
          <li><em>Statewide wins</em> &mdash; InformData maintains a statewide repository that satisfies county requirements.</li>
          <li><em>County coverage</em> &mdash; Orders are fulfilled by working the counties directly (no single statewide file or statewide data is supplementary only).</li>
        </ul>
      </div>
    </section>

    <section>
      <h2>Quick lists</h2>
      <style>
        .pill-grid{display:grid;gap:.6rem;grid-template-columns:repeat(auto-fit,minmax(140px,1fr))}
        .pill{display:inline-block;padding:.45rem .75rem;border:1px solid var(--border);border-radius:999px;background:#fff;color:#111827;font-weight:600;text-align:center}
        .group-title{font-weight:700;margin:.25rem 0}
      </style>
      <div class="pill-grid" id="list-statewide"></div>
      <div class="pill-grid" id="list-county"></div>
      <div id="list-note"></div>
    </section>

    <section>
      <h2>Dive deeper</h2>
      <div class="chip-row">
        <button class="chip active" data-filter="all">All states</button>
        <button class="chip" data-filter="statewide">Statewide covers counties</button>
        <button class="chip" data-filter="county">County coverage</button>
      </div>
      <table id="coverage-table" aria-live="polite">
        <thead>
          <tr>
            <th>State</th>
            <th>Statewide covers county?</th>
            <th>Recommended method</th>
            <th>Repository</th>
            <th>Courts sourced</th>
            <th>Notes</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <section>
      <h2>Operational notes</h2>
      <ul>
        <li><strong>Pricing impact:</strong> For statewide wins, sales can price county checks as state pulls (see pricing sheet). For county-required states, keep the higher court-runner rate.</li>
        <li><strong>Automation:</strong> States flagged “Auto FE” or “Auto CCH” run through InformData’s automated footprint, reducing turnaround time.</li>
        <li><strong>Exceptions:</strong> Indiana, Missouri, Pennsylvania, and Wisconsin appear twice in the source data. InformData explicitly recommends the statewide repository for county coverage in these states, so we treat them as statewide wins.</li>
        <li><strong>No statewide repository ≠ no coverage:</strong> “No statewide repository” simply means InformData does not have a single statewide file. In nearly every case it still fulfills orders by working the counties directly.</li>
      </ul>
    </section>
  </main>

  <script>
    async function loadCoverage() {
      const response = await fetch('content/pricing/informdata_statewide_coverage.csv');
      const text = await response.text();
      const lines = text.trim().split(/\r?\n/);
      const headers = lines.shift().split(',');
      const records = lines.map(line => {
        const values = [];
        let current = '';
        let inQuotes = false;
        for (let i = 0; i < line.length; i++) {
          const char = line[i];
          if (char === '"') {
            inQuotes = !inQuotes;
          } else if (char === ',' && !inQuotes) {
            values.push(current.trim());
            current = '';
          } else {
            current += char;
          }
        }
        values.push(current.trim());
        const obj = {};
        headers.forEach((key, idx) => {
          obj[key] = values[idx] ? values[idx].replace(/^"|"$/g, '') : '';
        });
        return obj;
      });

      const categories = {
        statewide: records.filter(r => r.statewide_recommended === 'Yes'),
        county: records.filter(r => r.statewide_recommended !== 'Yes')
      };
      const totals = {
        statewide: categories.statewide.length,
        county: categories.county.length,
        all: records.length
      };
      const statsEl = document.getElementById('stats');
      statsEl.innerHTML = `
        <div class="stat-card"><strong>${totals.statewide}</strong><span>States where a statewide search satisfies county coverage.</span></div>
        <div class="stat-card"><strong>${totals.county}</strong><span>States fulfilled via county researchers or portals.</span></div>
      `;

      function buildList(targetId, items, heading) {
        if (!items.length) return;
        const container = document.getElementById(targetId);
        const title = document.createElement('div');
        title.className='group-title';
        title.textContent = heading;
        container.appendChild(title);
        items
          .sort((a,b)=> a.state_name.localeCompare(b.state_name))
          .forEach(item => {
            const pill = document.createElement('span');
            pill.className='pill';
            pill.textContent=item.state_name;
            container.appendChild(pill);
          });
      }

      buildList('list-statewide', categories.statewide, 'Statewide covers county requirements');
      buildList('list-county', categories.county, 'Covered via county research only');
      const noteContainer = document.getElementById('list-note');
      if (noteContainer) {
        const note = document.createElement('div');
        note.className = 'callout';
        note.textContent = 'Every state is serviced: where no statewide file exists, InformData dispatches county researchers to fulfill orders.';
        noteContainer.appendChild(note);
      }

      const tbody = document.querySelector('#coverage-table tbody');
      function renderTable(data) {
        tbody.innerHTML = data.map(row => `
          <tr>
            <td>${row.state_name}</td>
            <td>${row.statewide_recommended === 'Yes' ? 'Yes' : 'No'}</td>
            <td>${row.recommended_method}</td>
            <td>${row.repository}</td>
            <td>${row.courts_sourced || ''}</td>
            <td>${row.details || ''}</td>
          </tr>
        `).join('');
      }

      renderTable(records);

      document.querySelectorAll('button.chip').forEach(button => {
        button.addEventListener('click', () => {
          document.querySelectorAll('button.chip').forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');
          const filter = button.dataset.filter;
          if (filter === 'statewide') renderTable(categories.statewide);
          else if (filter === 'county') renderTable(categories.county);
          else renderTable(records);
        });
      });
    }

    loadCoverage();
  </script>
  <script src="components/include.js" defer></script>
</body>
</html>
