<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vuplicity National Database Coverage</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles/tokens.css" />
  <style>
    .page { max-width: 1240px; margin: 0 auto; padding: 2.5rem 1.5rem 4rem; }
    header.hero { display: flex; flex-direction: column; gap: 1rem; margin-bottom: 2rem; }
    header.hero h1 { margin: 0; font-size: 2.4rem; font-weight: 700; }
    header.hero p { margin: 0; color: var(--muted); max-width: 70ch; }
    .summary-grid { display: grid; gap: 0.9rem; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); margin-bottom: 2rem; }
    .summary-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-xl); padding: 1.1rem 1.25rem; box-shadow: var(--shadow-lg); }
    .summary-card strong { display: block; font-size: 2rem; font-weight: 700; }
    .summary-card span { color: var(--muted); font-size: var(--fs-sm); }
    .panel { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-xl); padding: 1.2rem 1.4rem; box-shadow: var(--shadow-md); margin-bottom: 1.5rem; }
    .panel h2 { margin-top: 0; font-size: var(--fs-lg); }
    .panel p { margin-top: 0.2rem; color: var(--muted); }
    .list { display: grid; gap: 0.6rem; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); margin-top: 1rem; }
    .list-item { border: 1px solid var(--border); border-radius: var(--radius-md); padding: 0.75rem 0.85rem; background: rgba(37,99,235,0.05); }
    .list-item h3 { margin: 0; font-size: 1rem; font-weight: 600; }
    .list-item span { display: block; color: var(--muted); font-size: var(--fs-xs); margin-top: 0.2rem; }
    table { width: 100%; border-collapse: collapse; margin-top: 0.8rem; border: 1px solid var(--border); border-radius: var(--radius-xl); overflow: hidden; }
    thead th { background: var(--accent-soft); padding: 0.65rem; text-align: left; font-size: var(--fs-xs); text-transform: uppercase; letter-spacing: 0.04em; border-bottom: 1px solid var(--border); }
    tbody td { padding: 0.65rem; border-bottom: 1px solid var(--border); font-size: 0.95rem; }
    tbody tr:nth-child(even) { background: rgba(37,99,235,0.05); }
    .note { margin-top: 0.8rem; color: var(--muted); font-size: var(--fs-sm); }
    .chips { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.8rem; }
    footer { margin-top: 3rem; font-size: var(--fs-xs); color: var(--muted); }
    @media (max-width: 640px) {
      header.hero h1 { font-size: var(--fs-xl); }
      .page { padding: 2rem 1rem 3rem; }
    }
  </style>
</head>
<body>
  <div data-include=\"components/header.html\"></div>
  <main class="page">
    <header class="hero">
      <h1>Vuplicity National Database Coverage</h1>
      <p>The InformData national scan combines 2,400+ individual databases, watchlists, and corrections repositories. Use this reference to understand what is included, how often data refreshes, and how to articulate coverage to prospects.</p>
      <!-- Shared nav lives in components/header.html -->
    </header>

    <section class="summary-grid" id="summaryGrid" aria-live="polite">
      <article class="summary-card">
        <strong id="statUnique">--</strong>
        <span>Distinct databases (unique sources)</span>
      </article>
      <article class="summary-card">
        <strong id="statTopCategory">--</strong>
        <span>Largest category (sources)</span>
      </article>
      <article class="summary-card">
        <strong id="statTopState">--</strong>
        <span>Deepest state coverage</span>
      </article>
      <article class="summary-card">
        <strong id="statListings">--</strong>
        <span>Dataset listings (incl. county rows)</span>
      </article>
    </section>

    <section class="panel" id="categoryPanel">
      <h2>Coverage by database category</h2>
      <p>InformData maintains national feeds across corrections, courts, registries, and watchlists. Share these talking points when prospects ask “what’s in your national search?”</p>
      <div class="list" id="categoryList"></div>
    </section>

    <section class="panel" id="statePanel">
      <h2>States with the broadest footprint</h2>
      <p>These jurisdictions supply the highest volume of records in the national file. Tie this back to the candidate’s work locations when setting expectations.</p>
      <table>
        <thead>
          <tr>
            <th scope="col">State</th>
            <th scope="col">Sources tracked</th>
          </tr>
        </thead>
        <tbody id="stateTable"></tbody>
      </table>
      <p class="note">Counts represent distinct feeds per state (statewide repositories, Department of Corrections, county contributions, and specialty datasets).</p>
    </section>

    <section class="panel" id="messagingPanel">
      <h2>How to message Vuplicity coverage</h2>
      <p>Use these bullet points in decks and calls to translate database jargon into business value.</p>
      <div class="chips" id="messagingChips">
        <span class="chip">Alias expansion via SSN + address history</span>
        <span class="chip">State DOC, parole, and incarceration rosters</span>
        <span class="chip">50-state sex offender registry aggregation</span>
        <span class="chip">Domestic & international watchlists / sanctions</span>
        <span class="chip">County data feeds normalized for adjudication</span>
      </div>
      <p class="note">Need deeper validation? Pair national database hits with county confirmations using our Essential Check workflow.</p>
    </section>

    <section class="panel" id="freshnessPanel">
      <h2>Data freshness by category</h2>
      <p>Transparency on update cadence builds trust with compliance teams. Highlight the categories that refreshed most recently.</p>
      <table>
        <thead>
          <tr>
            <th scope="col">Category</th>
            <th scope="col">Last update</th>
          </tr>
        </thead>
        <tbody id="freshnessTable"></tbody>
      </table>
    </section>

    <footer>
      <p>Data source: InformData National Criminal repository snapshot (2025‑10‑03). Canonical files:
        <code>content/pricing/natcrim_sources_2025-10-03.csv</code>,
        <code>content/pricing/natcrim_record_type_totals_2025-10-03.csv</code>,
        <code>content/pricing/natcrim_state_totals_2025-10-03.csv</code>.
      </p>
    </footer>
  </main>
  <script src="components/include.js" defer></script>
  <script>
    async function fetchText(url){ const r = await fetch(url); if(!r.ok) throw new Error('Failed '+url); return r.text(); }
    function parseCSV(text){
      const lines = text.trim().split(/\r?\n/); if(!lines.length) return [];
      const headers = lines.shift().split(',');
      return lines.map(line=>{
        const out={}, vals=[]; let cur='', q=false; for(const ch of line){ if(ch==='"'){ q=!q;} else if(ch===',' && !q){ vals.push(cur); cur=''; } else { cur+=ch; } }
        vals.push(cur);
        headers.forEach((h,i)=> out[h]= (vals[i]??'').replace(/^"|"$/g,''));
        return out;
      });
    }

    function formatNumber(value) {
      return value.toLocaleString('en-US');
    }

    function formatDate(value) {
      const dt = new Date(value);
      if (Number.isNaN(dt.getTime())) return '—';
      return dt.toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: 'numeric' });
    }

    Promise.all([
      fetchText('content/pricing/natcrim_record_type_totals_2025-10-03.csv'),
      fetchText('content/pricing/natcrim_state_totals_2025-10-03.csv'),
      fetchText('content/pricing/natcrim_sources_2025-10-03.csv')
    ]).then(([typesCsv, statesCsv, sourcesCsv]) => {
      const recordTypeTotals = parseCSV(typesCsv).map(r=>({type:r.record_type, count:+r.record_count||0}));
      const stateTotals = parseCSV(statesCsv).map(r=>({state:r.state_name, code:r.standardized_state, count:+r.record_count||0}));
      const sources = parseCSV(sourcesCsv).map(r=>({
        sourceName: r.source_name,
        recordType: r.record_type,
        state: r.state_name,
        date: r.refresh_date
      }));

      const uniqueDatabases = new Set(sources.map(r=>r.sourceName)).size;
      document.getElementById('statUnique').textContent = uniqueDatabases.toLocaleString();
      document.getElementById('statListings').textContent = sources.length.toLocaleString();
      const topCategory = [...recordTypeTotals].sort((a,b)=>b.count-a.count)[0];
      if (topCategory) document.getElementById('statTopCategory').textContent = `${topCategory.type} (${formatNumber(topCategory.count)})`;
      const topState = [...stateTotals].sort((a,b)=>b.count-a.count)[0];
      if (topState) document.getElementById('statTopState').textContent = `${topState.code} (${formatNumber(topState.count)})`;
      // Drop explicit freshness tile in favor of listings count for clarity

      const categoryList = document.getElementById('categoryList');
      recordTypeTotals.slice(0,8).forEach(item=>{
        const card=document.createElement('article'); card.className='list-item';
        card.innerHTML = `<h3>${item.type||'Other'}</h3><span>${formatNumber(item.count)} records</span>`;
        categoryList.appendChild(card);
      });

      const stateTable = document.getElementById('stateTable');
      [...stateTotals].sort((a,b)=>b.count-a.count).slice(0,15).forEach(item=>{
        const tr=document.createElement('tr');
        tr.innerHTML = `<td>${item.state}</td><td>${formatNumber(item.count)}</td>`;
        stateTable.appendChild(tr);
      });

      const freshnessTable = document.getElementById('freshnessTable');
      const freshestByType = new Map();
      sources.forEach(r=>{
        const t=r.record_type; const d=r.refresh_date; if(!t||!d) return; if(!freshestByType.has(t) || new Date(d)>new Date(freshestByType.get(t))) freshestByType.set(t,d);
      });
      Array.from(freshestByType.entries()).sort((a,b)=> new Date(b[1])-new Date(a[1])).slice(0,10).forEach(([t,d])=>{
        const tr=document.createElement('tr'); tr.innerHTML=`<td>${t}</td><td>${formatDate(d)}</td>`; freshnessTable.appendChild(tr);
      });
    }).catch(err => {
      console.error(err);
      document.getElementById('summaryGrid').insertAdjacentHTML('afterend', `<p style="color:#b91c1c;">Unable to load coverage details right now. Please refresh or contact Sales Ops.</p>`);
    });
  </script>
</body>
</html>
