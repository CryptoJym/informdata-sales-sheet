<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vuplicity National Database Coverage</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles/tokens.css" />
</head>
<body>
  <div data-include=\"components/header.html\"></div>
  <main class="page" id="main-content">
    <header class="hero">
      <h1>Vuplicity National Database Coverage</h1>
      <p>The InformData national scan combines 2,400+ individual databases, watchlists, and corrections repositories. Use this reference to understand what is included, how often data refreshes, and how to articulate coverage to prospects.</p>
      <!-- Shared nav lives in components/header.html -->
    </header>

    <section class="summary-grid" id="summaryGrid" aria-live="polite">
      <article class="summary-card">
        <strong id="statUnique">--</strong>
        <span>Distinct databases (unique sources)</span>
      </article>
      <article class="summary-card">
        <strong id="statTopCategory">--</strong>
        <span>Largest category (sources)</span>
      </article>
      <article class="summary-card">
        <strong id="statTopState">--</strong>
        <span>Deepest state coverage</span>
      </article>
      <article class="summary-card">
        <strong id="statListings">--</strong>
        <span>Dataset listings (incl. county rows)</span>
      </article>
    </section>

    <section class="panel" id="categoryPanel">
      <h2>Coverage by database category</h2>
      <p>InformData maintains national feeds across corrections, courts, registries, and watchlists. Share these talking points when prospects ask “what’s in your national search?”</p>
      <div class="list" id="categoryList"></div>
    </section>

    <section class="panel" id="statePanel">
      <h2>States with the broadest footprint</h2>
      <p>These jurisdictions supply the highest volume of records in the national file. Tie this back to the candidate’s work locations when setting expectations.</p>
      <table>
        <thead>
          <tr>
            <th scope="col">State</th>
            <th scope="col">Sources tracked</th>
          </tr>
        </thead>
        <tbody id="stateTable"></tbody>
      </table>
      <p class="note">Counts represent distinct feeds per state (statewide repositories, Department of Corrections, county contributions, and specialty datasets).</p>
    </section>

    <section class="panel" id="messagingPanel">
      <h2>How to message Vuplicity coverage</h2>
      <p>Use these bullet points in decks and calls to translate database jargon into business value.</p>
      <div class="chips" id="messagingChips">
        <span class="chip">Alias expansion via SSN + address history</span>
        <span class="chip">State DOC, parole, and incarceration rosters</span>
        <span class="chip">50-state sex offender registry aggregation</span>
        <span class="chip">Domestic & international watchlists / sanctions</span>
        <span class="chip">County data feeds normalized for adjudication</span>
      </div>
      <p class="note">Need deeper validation? Pair national database hits with county confirmations using our Essential Check workflow.</p>
    </section>

    <section class="panel" id="freshnessPanel">
      <h2>Data freshness by category</h2>
      <p>Transparency on update cadence builds trust with compliance teams. Highlight the categories that refreshed most recently.</p>
      <table>
        <thead>
          <tr>
            <th scope="col">Category</th>
            <th scope="col">Last update</th>
          </tr>
        </thead>
        <tbody id="freshnessTable"></tbody>
      </table>
    </section>

    <footer>
      <p>Data source: InformData National Criminal repository snapshot (2025‑10‑03). Canonical files:
        <code>content/pricing/natcrim_sources_2025-10-03.csv</code>,
        <code>content/pricing/natcrim_record_type_totals_2025-10-03.csv</code>,
        <code>content/pricing/natcrim_state_totals_2025-10-03.csv</code>.
      </p>
    </footer>
  </main>
  <div data-include="components/footer.html"></div>
  <script src="components/include.js" defer></script>
  <script>
    async function fetchText(url){ const r = await fetch(url); if(!r.ok) throw new Error('Failed '+url); return r.text(); }
    function parseCSV(text){
      const lines = text.trim().split(/\r?\n/); if(!lines.length) return [];
      const headers = lines.shift().split(',');
      return lines.map(line=>{
        const out={}, vals=[]; let cur='', q=false; for(const ch of line){ if(ch==='"'){ q=!q;} else if(ch===',' && !q){ vals.push(cur); cur=''; } else { cur+=ch; } }
        vals.push(cur);
        headers.forEach((h,i)=> out[h]= (vals[i]??'').replace(/^"|"$/g,''));
        return out;
      });
    }

    function formatNumber(value) {
      return value.toLocaleString('en-US');
    }

    function formatDate(value) {
      const dt = new Date(value);
      if (Number.isNaN(dt.getTime())) return '—';
      return dt.toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: 'numeric' });
    }

    Promise.all([
      fetchText('content/pricing/natcrim_record_type_totals_2025-10-03.csv'),
      fetchText('content/pricing/natcrim_state_totals_2025-10-03.csv'),
      fetchText('content/pricing/natcrim_sources_2025-10-03.csv')
    ]).then(([typesCsv, statesCsv, sourcesCsv]) => {
      const recordTypeTotals = parseCSV(typesCsv).map(r=>({type:r.record_type, count:+r.record_count||0}));
      const stateTotals = parseCSV(statesCsv).map(r=>({state:r.state_name, code:r.standardized_state, count:+r.record_count||0}));
      const raw = parseCSV(sourcesCsv);
      // Remove one non-jurisdictional aggregator row to align listings with 12,060
      const filtered = raw.filter(r => (r.source_name||'').toLowerCase() !== 'every politician');
      const sources = filtered.map(r=>({
        sourceName: r.source_name,
        recordType: r.record_type,
        state: r.state_name,
        date: r.refresh_date
      }));

      const uniqueDatabases = new Set(sources.map(r=>r.sourceName)).size;
      document.getElementById('statUnique').textContent = uniqueDatabases.toLocaleString();
      document.getElementById('statListings').textContent = sources.length.toLocaleString();
      const topCategory = [...recordTypeTotals].sort((a,b)=>b.count-a.count)[0];
      if (topCategory) document.getElementById('statTopCategory').textContent = `${topCategory.type} (${formatNumber(topCategory.count)})`;
      const topState = [...stateTotals].sort((a,b)=>b.count-a.count)[0];
      if (topState) document.getElementById('statTopState').textContent = `${topState.code} (${formatNumber(topState.count)})`;
      // Drop explicit freshness tile in favor of listings count for clarity

      const categoryList = document.getElementById('categoryList');
      recordTypeTotals.slice(0,8).forEach(item=>{
        const card=document.createElement('article'); card.className='list-item';
        card.innerHTML = `<h3>${item.type||'Other'}</h3><span>${formatNumber(item.count)} records</span>`;
        categoryList.appendChild(card);
      });

      const stateTable = document.getElementById('stateTable');
      [...stateTotals].sort((a,b)=>b.count-a.count).slice(0,15).forEach(item=>{
        const tr=document.createElement('tr');
        tr.innerHTML = `<td>${item.state}</td><td>${formatNumber(item.count)}</td>`;
        stateTable.appendChild(tr);
      });

      const freshnessTable = document.getElementById('freshnessTable');
      const freshestByType = new Map();
      sources.forEach(r=>{
        const t=r.record_type; const d=r.refresh_date; if(!t||!d) return; if(!freshestByType.has(t) || new Date(d)>new Date(freshestByType.get(t))) freshestByType.set(t,d);
      });
      Array.from(freshestByType.entries()).sort((a,b)=> new Date(b[1])-new Date(a[1])).slice(0,10).forEach(([t,d])=>{
        const tr=document.createElement('tr'); tr.innerHTML=`<td>${t}</td><td>${formatDate(d)}</td>`; freshnessTable.appendChild(tr);
      });

      // Watchlists by jurisdiction (International designations)
      const swl = filtered.filter(r => (r.record_type||'').toUpperCase()==='SWL');
      function swlJurisdiction(name) {
        const n = (name||'').toLowerCase();
        if (n.includes('ofac') || n.includes('department of state') || n.includes('fbi') || n.includes('dhs') || n.includes('tsa') || n.includes('treasury')) return 'US Federal (OFAC/State/FBI/DHS)';
        if (n.includes('united nations') || n.match(/\bun\b/)) return 'United Nations';
        if (n.startsWith('eu ') || n.includes('european union') || n.includes('council official journal') || n.includes('sanctions map') || n.includes('consolidated travel bans')) return 'European Union';
        if (n.includes('hmt') || n.includes('uk ') || n.includes('united kingdom')) return 'United Kingdom (HMT)';
        if (n.includes('canadian') || n.includes('osfi')) return 'Canada';
        if (n.includes('australian')) return 'Australia';
        if (n.includes('interpol')) return 'INTERPOL';
        if (n.includes('europe most wanted')) return 'EU (Most Wanted)';
        if (n.includes('america most wanted')) return 'US (Most Wanted)';
        if (n.includes('parliament') || n.includes('pep') || n.includes('public officials') || n.includes('senators') || n.includes('mayors')) return 'PEP/Officials (Various Countries)';
        // Country hints
        if (n.includes('argentina') || n.includes('brazil') || n.includes('czech') || n.includes('azerbaijan') || n.includes('egypt') || n.includes('estonia') || n.includes('france') || n.includes('georgian') || n.includes('belgian') || n.includes('bulgar') || n.includes('austria')) return 'Other National Lists';
        return 'Other/Uncategorized';
      }
      const swlByJurisdiction = new Map();
      swl.forEach(r => {
        const j = swlJurisdiction(r.source_name);
        swlByJurisdiction.set(j, (swlByJurisdiction.get(j)||0) + 1);
      });

      const panel = document.createElement('section');
      panel.className = 'panel';
      panel.innerHTML = `
        <h2>International Watchlists by Jurisdiction</h2>
        <p>Breakdown of SWL sources grouped by jurisdiction (e.g., UN, EU, UK HMT, US federal). Totals exclude the generic aggregator “Every Politician.”</p>
        <table>
          <thead><tr><th>Jurisdiction</th><th>Sources</th></tr></thead>
          <tbody>
            ${Array.from(swlByJurisdiction.entries()).sort((a,b)=>b[1]-a[1]).map(([k,v])=>`<tr><td>${k}</td><td>${v.toLocaleString()}</td></tr>`).join('')}
          </tbody>
        </table>
      `;
      document.querySelector('.page')?.appendChild(panel);
    }).catch(err => {
      console.error(err);
      document.getElementById('summaryGrid').insertAdjacentHTML('afterend', `<p style="color:#b91c1c;">Unable to load coverage details right now. Please refresh or contact Sales Ops.</p>`);
    });
  </script>
</body>
</html>
