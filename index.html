<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vuplicity × InformData — Engineering Overview</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #0d1117; --surface: #0f1724; --card: #111a27; --text: #e6eef7; --muted: #94a3b8;
      --accent: #7dd3fc; --ok: #7ee0a3; --warn: #f7c948; --bad: #f87171;
      font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', sans-serif;
    }
    * { box-sizing: border-box; }
    body { margin:0; background:radial-gradient(circle at 20% 20%, rgba(125,211,252,.08), transparent 30%),
                     radial-gradient(circle at 75% 25%, rgba(126,224,163,.08), transparent 32%),
                     radial-gradient(circle at 50% 75%, rgba(247,201,72,.06), transparent 30%), var(--bg);
           color:var(--text); line-height:1.6; }
    .page { max-width:1220px; margin:0 auto; padding:32px 20px 48px; }
    h1{margin:0 0 8px;font-size:30px;} h2{margin:22px 0 10px;font-size:22px;} h3{margin:14px 0 6px;font-size:17px;}
    p{margin:6px 0 10px;color:var(--muted);} a{color:var(--accent);text-decoration:none;} a:hover{text-decoration:underline;}
    .grid{display:grid;gap:14px;} .cols-2{grid-template-columns:repeat(auto-fit,minmax(320px,1fr));}
    .card{background:var(--card);border:1px solid rgba(255,255,255,.06);border-radius:12px;padding:15px 16px;box-shadow:0 12px 34px rgba(0,0,0,.28);} 
    ul{margin:6px 0 10px 18px;color:var(--muted);} dl{margin:0;} dt{font-weight:700;} dd{margin:0 0 10px 0;color:var(--muted);} 
    .pill{display:inline-block;padding:2px 8px;border-radius:999px;font-size:12px;margin-right:6px;} .ok{background:rgba(126,224,163,.14);color:var(--ok);} .warn{background:rgba(247,201,72,.18);color:var(--warn);} .bad{background:rgba(248,113,113,.16);color:var(--bad);} 
    code{background:rgba(255,255,255,.05);padding:2px 6px;border-radius:6px;} footer{margin-top:24px;font-size:13px;color:var(--muted);} 
  </style>
</head>
<body>
  <div class="page">
    <header>
      <h1>Vuplicity × InformData — Engineering Overview</h1>
      <p>Front page for engineers finishing the InformData integration and background-check MVP.</p>
    </header>

    <section class="grid cols-2">
      <div class="card">
        <h2>Legend: Repositories</h2>
        <dl>
          <dt><a href="https://github.com/Vuplicity/vuplicity-api" target="_blank" rel="noopener"><code>vuplicity-api</code></a></dt>
          <dd>Node/Express API, Supabase, InformData & Stripe webhooks.</dd>
          <dt><a href="https://github.com/Vuplicity/vuplicity-workers" target="_blank" rel="noopener"><code>vuplicity-workers</code></a></dt>
          <dd>Consent → NATCRIM/County submission, AI processing, county orchestration.</dd>
          <dt><a href="https://github.com/Vuplicity/vuplicity-hr-portal" target="_blank" rel="noopener"><code>vuplicity-hr-portal</code></a></dt>
          <dd>React/Vite HR front-end: launch consent, view statuses.</dd>
          <dt><code>informdata-sales-sheet</code> (this repo)</dt>
          <dd>Docs, pricing, and engineering front page (you are here).</dd>
        </dl>
      </div>
      <div class="card">
        <h2>Intended MVP (must-have)</h2>
        <ul>
          <li>NATCRIM + SSN trace + auto county CRIMINAL (ZIP→county, statewide for syndicated states).</li>
          <li>Async webhook with idempotency & NEED_INFO handling; per-product status in portal.</li>
          <li>PII-safe: encrypted SSN, redacted AI, no SSN in logs/responses.</li>
          <li>Billing: package fee + pass-through court/data fees; Stripe webhook source of truth; invoices.</li>
          <li>Exports, audit trail, basic adverse/dispute timeline scaffolding.</li>
        </ul>
      </div>
    </section>

    <section class="grid cols-2">
      <div class="card">
        <h2>What Exists</h2>
        <ul>
          <li>InformData client (auth + NATCRIM + CRIMINAL); NATCRIM orderId stored; county submit with syndicated collapse & cap of 5.</li>
          <li>Webhook aggregates product statuses, updates background_checks, appends audit_trail.</li>
          <li>billing_transactions table; Stripe webhook signature verified; worker billing disabled.</li>
          <li>RLS tightened: background_checks authenticated-only; consumer_ssn service-role only; email_logs public removed.</li>
          <li>Exports (CSV/JSON) and conversation endpoint (audit trail) present.</li>
        </ul>
      </div>
      <div class="card">
        <h2>Gaps / Issues</h2>
        <ul>
          <li>ZIP→county still geocoder-based; no retry/backoff on county submits; limited monitoring.</li>
          <li>Portal: mixed candidate_id/consumer_id, no per-product/NEED_INFO chips, exports lack filters/pagination.</li>
          <li>PII audit incomplete; SSN not yet encrypted at rest in consumer_ssn; other AI paths unverified.</li>
          <li>Billing reconciliation incomplete (pass-through fees not applied; invoices absent).</li>
          <li>DLQ retry/alerts unscheduled; adverse/dispute flows minimal.</li>
        </ul>
      </div>
    </section>

    <section class="card">
      <h2>Recommendations → MVP</h2>
      <ol>
        <li><strong>Webhook & DLQ</strong>: enforce (event_id, order_id) idempotency; schedule DLQ retry; alert on pending_link/NEED_INFO/error via metrics.</li>
        <li><strong>County orchestration</strong>: static ZIP→FIPS map; retry/backoff; store per-county fees/ETA.</li>
        <li><strong>Portal alignment</strong>: consumer_id everywhere; product chips + NEED_INFO prompts; filtered/paginated exports; richer audit timeline.</li>
        <li><strong>PII & compliance</strong>: encrypt SSN; scrub logs/AI; formalize adverse/dispute notices.</li>
        <li><strong>Billing</strong>: total = package + pass-through fees (InformData pricing); update billing_transactions on COMPLETE/FAILED; invoices/receipts; legacy charging off.</li>
        <li><strong>Monitoring</strong>: alerts on metrics (pending_link/NEED_INFO/DLQ); stuck-state alarms; webhook latency budgets.</li>
      </ol>
    </section>

    <section class="grid cols-2">
      <div class="card">
        <h2>Key Features Map</h2>
        <p><span class="pill ok">Partial</span> works now · <span class="pill warn">Needs work</span> · <span class="pill bad">Missing</span></p>
        <ul>
          <li><span class="pill ok">Partial</span> NATCRIM submit with real orderId; county submit limited.</li>
          <li><span class="pill warn">Needs work</span> ZIP/FIPS accuracy + retries.</li>
          <li><span class="pill warn">Needs work</span> NEED_INFO UX & per-product portal display.</li>
          <li><span class="pill warn">Needs work</span> Billing reconciliation & pass-through fees.</li>
          <li><span class="pill ok">Partial</span> RLS tightened; SSN encryption outstanding.</li>
          <li><span class="pill bad">Missing</span> Adverse/dispute workflows & candidate portal.</li>
        </ul>
      </div>
      <div class="card">
        <h2>Developer Quick Start</h2>
        <ul>
          <li><strong>API</strong>: InformData client, webhook, billing, exports.</li>
          <li><strong>Workers</strong>: consent → NATCRIM/County submit, AI compliance, DLQ.</li>
          <li><strong>Portal</strong>: consumer_id switch, product chips, exports UI.</li>
          <li><strong>Supabase</strong>: RLS, billing_transactions, informdata_products/webhooks.</li>
        </ul>
        <p>Docs in this repo: 
          <a href="api_docs.html">API docs</a> ·
          <a href="natcrim_overview.html">NATCRIM overview</a> ·
          <a href="statewide_vs_county.html">Statewide vs County</a> ·
          <a href="county_fee_breakdown.html">County fee breakdown</a> ·
          <a href="informdata_source_list.html">Source list</a>
        </p>
        <p>Repo links: 
          <a href="https://github.com/Vuplicity/vuplicity-api" target="_blank" rel="noopener">vuplicity-api</a> ·
          <a href="https://github.com/Vuplicity/vuplicity-workers" target="_blank" rel="noopener">vuplicity-workers</a> ·
          <a href="https://github.com/Vuplicity/vuplicity-hr-portal" target="_blank" rel="noopener">vuplicity-hr-portal</a>
        </p>
      </div>
    </section>

    <footer>
      Sources: InformData (https://www.informdata.com/) · This repo’s reference sheets (links above).
    </footer>
  </div>
</body>
</html>
